---
user_list:
- KETAF
- DoMoJoLi
- Daniel
- Sofia
- Andreas
- Hanni
- Günther
---
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bestellübersicht</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>

<h1>Bestellungsübersicht</h1>

<table class="order-summary-table">
    <tr>
        <th></th>
        <th>Summe</th>
        {% for user in page.user_list %}
            <th>
                {{ user }}
            </th>
        {% endfor %}
    </tr>

    {% for good in site.data.goods %}
        <tr>
            <th>
                {{ good.name }}
            </th>
            <td id="order-sum-{{ good.i }}">
                ??
            </td>
            {% for user in page.user_list %}
                <td id="order-count-{{ user | downcase }}-{{ good.i }}">
                    ??
                </td>
            {% endfor %}
        </tr>
    {% endfor %}
</table>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
<script type="text/javascript">
    $.get("https://getpantry.cloud/apiv1/pantry/3434fa84-88b8-41ad-8cfb-36088d6c14c1/basket/orders", function (data) {
        const sum = {};

        function processUser(user) {
            const orders = data[user + "Orders"] ?? {};
            for (let i = 0; i < 12; i++) {
                const domId = "#order-count-" + user + "-" + (i + 1);
                const o = orders["b" + i] ?? 0;
                $(domId).text(o);
                sum["b" + i] = (sum["b" + i] ?? 0) + o;
            }
        }
        {% for user in page.user_list %}
        processUser("{{ user | downcase }}");
        {% endfor %}
        for (let i = 0; i < 12; i++) {
            $("#order-sum-" + (i + 1)).text(sum["b" + i]);
        }
    });
</script>

</body>

</html>